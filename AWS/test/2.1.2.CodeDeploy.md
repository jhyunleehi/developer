AWS DVA-C02 시험에서 CodeDeploy는 애플리케이션 배포 자동화를 위한 핵심 서비스입니다. 이 서비스는 EC2, Lambda, ECS에 애플리케이션을 자동으로 배포하는 역할을 하며, 시험에서는 주로 배포 과정, 구성 및 문제 해결에 대한 시나리오 기반 질문이 출제될 수 있습니다. 아래는 CodeDeploy와 관련된 예상 질문과 답변을 정리한 것입니다.

### 1. CodeDeploy에서 배포 유형 두 가지는 무엇인가요? 언제 사용하나요?
질문: AWS CodeDeploy는 어떤 배포 유형을 지원하며, 각각의 장점과 사용 사례는 무엇인가요?

답변:

In-place 배포 (In-place or Rolling Deployments): 기존 EC2 인스턴스에 새로운 애플리케이션 버전을 배포하고, 기존 애플리케이션을 중단하고 새 버전을 배포합니다. 배포는 각 인스턴스에서 순차적으로 이루어집니다.

장점: 추가 인스턴스가 필요 없고, 인프라 비용이 적음.
단점: 배포 중에는 인스턴스의 일부가 비활성 상태이므로 가용성이 낮아질 수 있음.
사용 사례: 테스트 환경 또는 트래픽이 적은 상황에서 적합.
블루/그린 배포 (Blue/Green Deployments): 새 버전의 애플리케이션을 별도의 새로운 인스턴스(그린 환경)에 배포한 후, 트래픽을 새 인스턴스로 전환합니다.

장점: 애플리케이션 중단 없이 배포가 가능하고, 문제가 생기면 빠르게 롤백할 수 있음.
단점: 추가 인프라가 필요하여 비용이 증가할 수 있음.
사용 사례: 프로덕션 환경에서 사용해 다운타임 없이 안정적으로 배포할 때 유용.

### 2. AppSpec.yml 파일의 역할은 무엇인가요?
질문: AWS CodeDeploy에서 AppSpec.yml 파일은 무엇을 하는 파일인가요?

답변:

AppSpec.yml 파일은 CodeDeploy 배포 프로세스 중 수행할 작업을 정의하는 구성 파일입니다. 인스턴스에 배포하는 파일과 실행해야 할 명령어를 지정합니다. AppSpec.yml 파일은 두 가지 방식으로 사용됩니다:
EC2/온프레미스 배포:
파일 복사 및 애플리케이션 시작, 중지와 같은 명령어를 정의.
예: hooks 섹션에서 특정 시점에 실행할 명령어를 정의.
Lambda 및 ECS 배포:
Lambda 함수 및 ECS 작업을 배포하는데 필요한 파라미터를 정의.
예시:

```yaml
version: 0.0
os: linux
files:
  - source: /src
    destination: /var/www/html
hooks:
  AfterInstall:
    - location: scripts/install_dependencies.sh
      timeout: 300
      runas: root
```
* 버전: AppSpec 파일의 버전.
* files: 배포할 파일의 소스 및 대상 경로.
* hooks: 배포 단계에서 실행할 스크립트.

### 3. CodeDeploy의 배포 상태를 모니터링하는 방법은 무엇인가요?
질문: CodeDeploy에서 배포의 상태를 모니터링하거나 실패를 분석하는 방법은 무엇인가요?

답변:

CloudWatch Events: CodeDeploy와 CloudWatch Events를 사용해 배포 상태를 모니터링할 수 있습니다. 배포 성공, 실패 등 주요 상태 변경 이벤트에 대해 알림을 받을 수 있습니다.

CodeDeploy 콘솔: AWS Management Console에서 배포 상태를 실시간으로 확인할 수 있습니다. 배포 진행 상황과 오류 발생 시 해당 오류 메시지를 볼 수 있습니다.

CloudWatch Logs: 배포 중 로그를 CloudWatch Logs에 저장하여 세부적인 빌드 및 배포 오류를 추적할 수 있습니다.

CodeDeploy 이벤트 모니터링: CodeDeploy는 배포의 각 단계에서 발생하는 이벤트(설치, 애플리케이션 시작, 종료 등)에 대한 로그를 기록합니다. 이를 통해 어디서 오류가 발생했는지 확인할 수 있습니다.

### 4. CodeDeploy에서 배포 실패 시 롤백을 자동으로 수행하려면 어떻게 해야 하나요?
질문: 배포가 실패했을 때 자동으로 롤백이 되도록 설정하려면 어떻게 해야 하나요?

답변:

CodeDeploy는 배포 실패 시 자동으로 롤백하는 기능을 제공합니다. 롤백을 설정하려면 배포 그룹 설정에서 롤백 조건을 지정할 수 있습니다.

롤백 활성화 방법:

CodeDeploy 콘솔에서 배포 그룹을 선택한 후, "배포 실패 시 롤백" 옵션을 활성화합니다.
롤백 조건에는 다음을 포함할 수 있습니다:
최소 배포 완료 실패: 전체 인스턴스 중 지정된 비율 이상의 인스턴스에서 배포가 실패하면 롤백.
애플리케이션이 실패한 경우: 배포 후 애플리케이션이 실패하면 롤백.
Lambda 배포에서의 롤백:

Lambda 배포의 경우, 실패한 버전으로부터 이전에 배포한 안정적인 버전으로 Lambda 함수를 자동으로 롤백할 수 있습니다.

### 5. CodeDeploy의 배포 생명주기 훅(Lifecycle Hooks)에 대해 설명해보세요.
질문: AWS CodeDeploy에서 배포 생명주기 훅이란 무엇이며, 어떤 단계에서 실행되나요?

답변:

*배포 생명주기 훅(Lifecycle Hooks)*는 CodeDeploy에서 배포 중 특정 시점에 실행할 스크립트나 명령어를 정의하는 기능입니다. 이 훅을 통해 사용자 정의 작업을 자동으로 수행할 수 있습니다.

주요 생명주기 훅 단계:

* BeforeInstall: 애플리케이션 설치 전에 실행. 기존 파일 제거 또는 디렉토리 생성 같은 작업.
* Install: 애플리케이션 파일을 대상 인스턴스에 복사.
* AfterInstall: 애플리케이션 설치 후 실행. 구성 파일 설정 등.
* ApplicationStart: 애플리케이션을 시작하는 스크립트를 실행.
* ValidateService: 배포가 완료된 후 서비스 상태를 검증하는 단계.
예시:

```yaml
hooks:
  BeforeInstall:
    - location: scripts/stop_server.sh
      timeout: 300
  AfterInstall:
    - location: scripts/install_dependencies.sh
      timeout: 300
  ApplicationStart:
    - location: scripts/start_server.sh
      timeout: 300
  ValidateService:
    - location: scripts/validate.sh
      timeout: 300
```      

### 6. CodeDeploy와 다른 AWS 서비스의 통합은 어떻게 이루어지나요?
질문: AWS CodeDeploy는 다른 AWS 서비스들과 어떻게 통합되며, 주요 통합 사용 사례는 무엇인가요?

답변:

CodePipeline 통합: AWS CodeDeploy는 AWS CodePipeline의 배포 단계에서 주로 사용됩니다. 소스 코드가 변경되면 CodeBuild를 통해 빌드가 완료되고, CodeDeploy가 최종 배포를 담당합니다. 이로써 전체 CI/CD 파이프라인을 자동화할 수 있습니다.

CloudWatch 통합: CloudWatch Events 및 CloudWatch Logs와의 통합을 통해 배포 이벤트에 대한 알림을 설정하고, 배포 로그를 실시간으로 모니터링할 수 있습니다.

S3 통합: CodeDeploy는 애플리케이션 배포 아티팩트를 Amazon S3에 저장하고 해당 아티팩트를 배포하는 데 사용합니다.

IAM 역할: CodeDeploy가 EC2 인스턴스, Lambda 함수 또는 ECS 작업에 접근하여 배포 작업을 수행할 수 있도록 적절한 IAM 역할을 부여해야 합니다.

### 7. CodeDeploy에서 EC2 인스턴스를 배포 대상으로 추가하려면 어떻게 해야 하나요?
질문: AWS CodeDeploy에서 EC2 인스턴스를 배포 대상으로 추가하려면 어떤 절차를 거쳐야 하나요?

답변:

EC2 인스턴스를 배포 대상으로 추가하려면 해당 인스턴스에 CodeDeploy 에이전트를 설치해야 합니다.

절차:

EC2 인스턴스에 CodeDeploy 에이전트 설치: yum install codedeploy-agent 또는 apt-get install codedeploy-agent 명령을 사용해 설치.
IAM 역할 부여: EC2 인스턴스가 Code